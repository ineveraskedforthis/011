global{no-conversions}


object{
	name{storage}
	size{40000}
	storage_type{erasable}

	property{
		name{current}
		type{array{commodity_id}{int32_t}}
	}
	property{
		name{limit}
		type{array{commodity_id}{int32_t}}
	}

	property{
		name{owner}
		type{user_id}
	}
	property{
		name{attached_to}
		type{building_id}
	}
}

relationship{
	name{transfer}
	size{30000}
	storage_type{erasable}
	link{
		object{storage}
		name{source}
		type{many}
	}
	link{
		object{storage}
		name{target}
		type{many}
	}
	property{
		name{current}
		type{array{commodity_id}{int32_t}}
	}
	property{
		name{accumulated_power}
		type{float}
	}
	composite_key{
		name{transfer_pair}
		index{source}
		index{target}
	}
}

object{
	name{user}
	size{10000}
	storage_type{erasable}
	property{
		name{wealth}
		type{__uint128_t}
	}

	property{
		name{name}
		type{uint32_t}
	}

	property{
		name{pwd_hash}
		type{array{uint8_t}{uint8_t}}
	}

	property{
		name{storage}
		type{storage_id}
	}

	property{
		name{development_tickets}
		type{uint32_t}
	}
}



object{
	name{commodity}
	size{500}
	storage_type{erasable}

	property{
		name{name}
		type{uint32_t}
	}
	property{
		name{inversed_density}
		type{uint32_t}
	}
}

object{
	name{activity}
	property{
		name{name}
		type{uint32_t}
	}
	property{
		name{required_power}
		type{float}
	}
	property{
		name{produced_power}
		type{float}
	}
	property{
		name{input_amount}
		type{array{uint8_t}{int32_t}}
	}
	property{
		name{input}
		type{array{uint8_t}{commodity_id}}
	}
	property{
		name{output_amount}
		type{array{uint8_t}{int32_t}}
	}
	property{
		name{output}
		type{array{uint8_t}{commodity_id}}
	}
	property{
		name{operation_tick_per_production_tick}
		type{int32_t}
	}
}

object{
	name{building_type}
	size{300}
	storage_type{erasable}
	property{
		name{name}
		type{uint32_t}
	}
	property{
		name{activities}
		type{array{uint8_t}{activity_id}}
	}

	property{
		name{construction_amount}
		type{array{uint8_t}{int32_t}}
	}
	property{
		name{construction}
		type{array{uint8_t}{commodity_id}}
	}
}

object{
	name{building}
	size{30000}
	storage_type{erasable}
	property{
		name{building_type}
		type{building_type_id}
	}
	property{
		name{power}
		type{float}
	}
	property{
		name{storage}
		type{storage_id}
	}
	property{
		name{operation_tick}
		type{int32_t}
	}
	property{
		name{activity}
		type{activity_id}
	}
	property{
		name{constructed}
		type{bitfield}
	}
}

relationship{
	name{ownership}
	size{30000}
	storage_type{erasable}

	link{
		object{building}
		name{owned}
		type{unique}
	}
	link{
		object{user}
		name{owner}
		type{many}
	}
	composite_key{
		name{ownership_pair}
		index{owned}
		index{owner}
	}
}

object{
	name{supply}
	size{300000}
	storage_type{erasable}
	property{
		name{cid}
		type{commodity_id}
	}
	property{
		name{price}
		type{__uint128_t}
	}
	property{
		name{storage}
		type{__uint128_t}
	}
	property{
		name{target_storage}
		type{int32_t}
	}
	property{
		name{last_tick_volume}
		type{int32_t}
	}
}

object{
	name{demand}
	size{300000}
	storage_type{erasable}
	property{
		name{cid}
		type{commodity_id}
	}
	property{
		name{price}
		type{__uint128_t}
	}
	property{
		name{volume}
		type{__uint128_t}
	}
	property{
		name{target_volume}
		type{__uint128_t}
	}
	property{
		name{auto_refresh}
		type{bitfield}
	}
}

relationship{
	name{supply_ownership}
	size{30000}
	storage_type{erasable}
	link{
		object{supply}
		name{supply}
		type{unique}
	}
	link{
		object{user}
		name{owner}
		type{many}
	}
}


relationship{
	name{demand_ownership}
	size{30000}
	storage_type{erasable}
	link{
		object{demand}
		name{demand}
		type{unique}
	}
	link{
		object{user}
		name{owner}
		type{many}
	}
}